clear; MS=$(printf "%50s");echo ${MS// /-}; echo -en "\e[31m\e[1m$(cat /etc/issue |grep Type| sed 's/Type: //')"; cat /etc/issue| grep VMware| awk '{print " - " $NF}'; echo -e "\e[0mDate & Time: $(date)"; vpxd -v| awk '{print "VC version :",$3,$4}'; echo "Hostname   : $(hostname -f)"; /usr/lib/vmware-vmafd/bin/vmafd-cli get-ls-location --server-name localhost| awk -F "/" '{print $3}'| awk -F ":" '{print "PSC        :",$1}'; echo -e "PNID       : $(/usr/lib/vmware-vmafd/bin/vmafd-cli get-pnid --server-name localhost)"; echo -en "Machine ID : "; /usr/lib/vmware-vmafd/bin/vmafd-cli get-machine-id --server-name localhost; echo -en "Node ID    : "; echo $(cat /etc/vmware/install-defaults/vmdir.ldu-guid); networkctl status| egrep 'Gateway|Address'| sed 's/^ \+//'| sed -e 's/Address/IP address /' -e 's/Gateway/Gateway    /'; ifconfig eth0| grep Mask| awk -F ":" '{print "Subnet     :",$4}'; echo "DNS        : $(cat /etc/resolv.conf| grep nameserver| awk '{ print $2}'| paste -sd ","|sed 's/,/, /g')"; echo "NTP servers: $(cat /etc/ntp.conf | grep server | awk '{ print $2}'| paste -sd ","|sed 's/,/, /g')"; echo "Hosts file : /etc/hosts";cat /etc/hosts | egrep -v "#|^$"| awk '{print "           : "$0}'; echo -e "VC Domain  : $(/opt/likewise/bin/lwregshell list_values '[HKEY_THIS_MACHINE\Services\vmafd\Parameters]'| grep DomainName| awk '{print $4}'| tr -d '"')"; /opt/likewise/bin/domainjoin-cli query| grep Domain| sed 's/^Domain =/AD Domain  :/'; echo  "Datacenters: $(/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres -c "select id from vpx_datacenter"| egrep "row)|rows)"| cut -d " " -f1| sed 's/(//g')"; echo "Clusters   : $(/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres -c "select id from vpx_compute_resource"| egrep "row)|rows)"| cut -d " " -f1| sed 's/(//g')"; echo "ESXi Hosts : $(/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres -c "SELECT id from vpx_host"| grep "rows)"| cut -d " " -f1| sed 's/(//g')"; echo "VM's       : $(/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres -c "SELECT id from vpx_vm"| grep "rows)"| cut -d " " -f1| sed 's/(//g')"; echo "CPU's      : $(cat /proc/cpuinfo| grep -c processor)"; echo "RAM Total  : $(free --giga | grep Mem| awk '{print $2}')GB"; echo "RAM Used   : $(free --giga | grep Mem| awk '{print $3}')GB"; echo "Swap Total : $(free --giga | grep Swap| awk '{print $2}')GB"; echo "Swap Used  : $(free --giga | grep Mem| awk '{print $3}')GB"; echo "Proxy      : $(cat /etc/sysconfig/proxy | grep PROXY_ENABLED| cut -d = -f2 | sed 's/"//g')"; echo -n "vPostgres  : "; du -sh /storage/db/vpostgres/| awk '{print $1, $2}'; du -sh /storage/seat/vpostgres/| awk '{print "           : "$1, $2}'; echo "VCDB Size  : $(/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres -c "select pg_size_pretty(pg_database_size('VCDB'))"| grep MB| sed 's/^ //g')"; echo "Uptime     :$(uptime | sed -e 's/[[:blank:]]\+/ /g'| awk -F "," '{print $1, $2}'| awk -F "up" '{print $2}')"; echo; service-control --status| sed -e 's/:/ Services:/' -e 's/^ //'; echo; PPS=$PS1; echo -e "CPU and Mem Usage:"; top -n 1| egrep "Cpu|GiB"| sed 's/GiB/%of/'| egrep -v "root"; PS1=$PPS; if [[ "$(df -h)" =~ [7-9][0-9]%|100% ]]; then echo -e "\e[33m\e[1mDisplaying filesystem greater than 70% usage:\e[0m"; df -h| head -1; df -h| egrep --color=never '[7-9][0-9]%|100%'; fi; if [[ "$(df -i)" =~ [7-9][0-9]%|100% ]]; then echo -e "\e[33m\e[1mDisplaying inode greater than 70% usage:\e[0m"; df -i| head -1; df -i| egrep --color=never '[7-9][2-9]%|100%'; fi; echo ${MS// /-}; PS1=$PPS; history -d $(history | tail -1)
